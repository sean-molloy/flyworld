// room script file

int abisExpressionChanged = 1;
/*
1 = normal
2 = angry
*/

function room_Load()
{
  oSideEyes.SetView(36, 0, 0);
}

int whichExpression = 0;
/*
 0 = nothing
 1 = get angry
 2 = stop angry
 3 = side eye
 4 = stop side eye
 5 = locked
*/

function timerGetAngry()
{
  if( whichExpression == 1)
  {
    if(IsTimerExpired(7))
    {    
      cAbiCloseSpeech.LockView(180);
      cAbiCloseSpeech.Animate(0, 0, eOnce, eNoBlock, eForwards);     
      abisExpressionChanged = 2;        
    }
  }  
}

function timerStopBeingAngry()
{
  if(whichExpression == 2)
  {
    if(IsTimerExpired(7))
    {      
      cAbiCloseSpeech.LockView(180);
      cAbiCloseSpeech.Animate(0, 0, eOnce, eNoBlock, eBackwards, 2);
      abisExpressionChanged = 1;        
    }
  }
}



function getAngry(float seconds)
{
  whichExpression = 1;
  SetTimerWithSeconds(7, seconds);     
}

function stopBeingAngry(float seconds)
{
  whichExpression = 2;
  SetTimerWithSeconds(7, seconds);
}
function abiSays(String sheSays)
{  
  if(abisExpressionChanged == 1)
  {
     cAbiCloseSpeech.SpeechView = 12;
     cAbiCloseSpeech.ChangeView(12);
  } else if(abisExpressionChanged == 2)
  {
    cAbiCloseSpeech.ChangeView(179);
    cAbiCloseSpeech.SpeechView = 179;
  }
  cAbiCloseSpeech.SayAtSync(30, 40, 300, sheSays);
}

function room_AfterFadeIn()
{
  WaitSeconds(1.0);
  
  abiSays("&1 G'Day, Abigeil,");
  WaitSeconds(0.5);
  abiSays("&1 G'Day, Abigeil,");
  getAngry(0.1);
  WaitSeconds(2.0);
  
  
  abiSays("&1 G'Day, Abigeil,");
  stopBeingAngry(0.2);
  WaitSeconds(0.5);
  abiSays("&1 G'Day, Abigeil,");  
  WaitSeconds(0.5);
  abiSays("&1 G'Day, Abigeil,");
  WaitSeconds(0.5);
  abiSays("&1 G'Day, Abigeil,");
  WaitSeconds(0.5);
  
}

function room_Leave()
{

}

function room_RepExec()
{

}

function late_repeatedly_execute_always()
{
  timerGetAngry();
  timerStopBeingAngry();
}