// room script file

function setupCupboard(Object* cup)
{
  if(cup.GetProperty("isItOpen"))
  {
    if(cup.ID < 6)
    {
      cup.SetView(80, 0, 6);
    } else {
      cup.SetView(81, 0, 6);
    }
  } else {
    if(cup.ID < 6)
    {
      cup.SetView(80, 0, 0);
    } else {
      cup.SetView(81, 0, 0);
    }
  }
}

function setupCupboards()
{
  setupCupboard(oSRCup1);
  setupCupboard(oSRCup2);
  setupCupboard(oSRCup3);
  setupCupboard(oSRCup4);
  setupCupboard(oSRCup5);
  setupCupboard(oSRCup6);
  setupCupboard(oSRCup7);
  setupCupboard(oSRCup8);
  setupCupboard(oSRCup9);
  setupCupboard(oSRCup10);
}

function room_FirstLoad()
{
 setupCupboards();
}


function room_Load()
{
 
  if(characterChange)
  {
    Game.Camera.SetAt(138, 0);
  } else {
    Game.Camera.SetAt(0, 0);
  }
   resumeMusicAfterCHCH(aEndlessOffice);
   changePlayerLocaleOnRoomEnter();
   player.PlaceOnWalkableArea();
}


function room_AfterFadeIn()
{
   if(characterChange)
  {
   characterChange = false;        
  } else {
    Game.Camera.TweenX(1.5, 138, eEaseInOutCubicTween, eNoBlockTween);
  }
}
function region1_WalksOnto()
{
  player.ChangeRoom(14, player.x + 224, player.y);
}

function openCupboard(Object* cup)
{
  cup.toggleStatusOpenShut();
  cup.toggleVerbOpenShut();
  if(cup.GetProperty("isItOpen"))
  {    
    cup.Animate(0, 1, eOnce, eBlock, eForwards);
  } else {    
    cup.Animate(0, 1, eOnce, eBlock, eBackwards);
  }
}

function cupBoardInteract(Object* cup)
{
int cupX = cup.GetProperty("XX");
int cupY = cup.GetProperty("YY");
switch (verbUsed)
{
  case 0: //walk
    walkToAndFace(cupX, cupY, eDirectionUp, cupX + 5, cupY + 7); 
  break;
  case 1://look
    player.FaceLocation(cupX, cupY, eBlock);
    lookAbiPaul("", "");
  break;
  case 2://use
    noUsing();
  break;
  case 3://talk
    noTalking();
  break;
  case 4://move
    openCupboard(cup);
  break;
  case 5://fourletters
    fuckAnyone();
  break;
  case 6://take
    cantTake();
  break;
  case 7://inv
    wontWork();
  break;
}
verbUsed = 0;

  
}


function oSRCup1_AnyClick(){    cupBoardInteract(oSRCup1);  }
function oSRCup2_AnyClick(){    cupBoardInteract(oSRCup2);  }
function oSRCup3_AnyClick(){    cupBoardInteract(oSRCup3);  }
function oSRCup4_AnyClick(){    cupBoardInteract(oSRCup4);  }
function oSRCup5_AnyClick(){    cupBoardInteract(oSRCup5);  }
function oSRCup6_AnyClick(){    cupBoardInteract(oSRCup6);  }
function oSRCup7_AnyClick(){    cupBoardInteract(oSRCup7);  }
function oSRCup8_AnyClick(){    cupBoardInteract(oSRCup8);  }
function oSRCup9_AnyClick(){    cupBoardInteract(oSRCup9);  }
function oSRCup10_AnyClick(){   cupBoardInteract(oSRCup10); }




