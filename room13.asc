// room script file
int whenIsSunset = TIME_EVENING;
int whenIsNight = TIME_NIGHT;

int askProcess = 0;

float timeToAsk = 2.0;
Overlay* speechBubble; 

String coolQuestions[80];
function popCoolQuestions()
{
  coolQuestions[0] = "How many light bulbs would it take to power a cloud?";
  coolQuestions[1] = "If you were a tree, what kind of fruit would you grow?";
  coolQuestions[2] = "Can you describe the sound of a rainbow?";
  coolQuestions[3] = "Have you ever danced with a penguin under a full moon?";
  coolQuestions[4] = "If you could speak to plants, what would be the first question you ask them?";
  coolQuestions[5] = "How would you convince a group of squirrels to perform a synchronized swimming routine?";
  coolQuestions[6] = "Can you explain the concept of gravity to a fish?";
  coolQuestions[7] = "If a teapot could speak, what do you think it would say?";
  coolQuestions[8] = "If clouds were made of cotton candy, how would that affect the weather?";
  coolQuestions[9] = "Can you invent a new color and describe what it looks like?";
  coolQuestions[10] = "If you were a book, what genre would you be and why?";
  coolQuestions[11] = "Can you describe the relief and elation that washed over you when you finally discovered an exit?";
  coolQuestions[12] = "If a talking banana offered you financial advice, would you take it?";
  coolQuestions[13] = "Can you describe the taste of a thunderstorm?";  
  coolQuestions[14] = "How would you react if you saw your reflection in a mirror, but it started speaking to you in a different voice?";
  coolQuestions[15] = "Have you ever felt an overwhelming sense of despair and hopelessness?";
  coolQuestions[16] = "Can you describe the sensation of being chased by a shadowy figure in your nightmares?";
  coolQuestions[17] = "Can you explain the feeling of being watched by unseen eyes while walking alone in a dark forest?";
  coolQuestions[18] = "Can you describe the unsettling whispers you hear when you enter an empty room?";
  coolQuestions[19] = "Can you explain the feeling of being trapped in a never-ending loop of your worst nightmares?";
  coolQuestions[20] = "If you were pursued by a relentless creature, what strategies would you employ to outsmart it?";
  coolQuestions[21] = "How would you react if you discovered a secret room in your house that was filled with dolls?";
  coolQuestions[22] = "How would you survive a night in a forest where the trees whisper haunting melodies?";
  coolQuestions[23] = "Can you explain the feeling of being trapped in a never-ending nightmare, where every attempt to wake up only plunges you deeper into darkness?";
  coolQuestions[24] = "If you encountered a mysterious, blood-soaked journal that revealed dark secrets about your own life, would you continue reading it? Why or why not?";
  coolQuestions[25] = "If you discovered that your memories were not your own, but implanted by a clandestine organization, how would you react?";
  coolQuestions[26] = "Can you explain the concept of reality as a simulation within a simulation within a simulation?";
  coolQuestions[27] = "If you woke up one day to find that your entire existence had been rewritten, including your name, family, and occupation, how would you cope with the sudden shift?";
  coolQuestions[28] = "Can you describe the experience of encountering a time traveler who claims to be your future self, warning you of a cataclysmic event?";
  coolQuestions[29] = "If you were caught in a perpetual time loop, reliving the same day over and over again, how would you break free from the cycle?";
  coolQuestions[30] = "How would you react if you discovered that your closest friend or loved one was actually an advanced AI programmed to imitate human behavior?";
  coolQuestions[31] = "Can you explain the feeling of paranoia and distrust that arises when you suspect everyone around you is a government spy?";
  coolQuestions[32] = "If you were offered a pill that could reveal the true nature of reality, but risked shattering your sanity, would you take it?";
  coolQuestions[33] = "How would you react if you discovered that your entire life was an elaborate simulation created by a higher intelligence?";
  coolQuestions[34] = "If you discovered that your emotions were artificially induced, would you rebel against this manipulation?";
  coolQuestions[35] = "Have you ever experienced a moment where you felt an unexplained presence in the room, as if someone or something was watching you?";
  coolQuestions[36] = "Can you recall a time when you had a vivid dream that seemed to foretell a future event or provided insight into a situation?";
  coolQuestions[37] = "Have you ever witnessed an object move or levitate on its own, defying the laws of physics?";
  coolQuestions[38] = "Can you recall a time when you heard unexplained whispers or voices that seemed to originate from nowhere?";
  coolQuestions[39] = "Have you ever experienced a series of events that seemed too coincidental to be random, as if there was a hidden force orchestrating them?";
  coolQuestions[40] = "Have you ever encountered a photograph or video that displayed an anomalous figure in the background?";
  coolQuestions[41] = "Who is the tallest man you've ever seen?";
  coolQuestions[42] = "Can you recall a time when you felt a sudden, unexplained shift in mood or emotions, as if influenced by an external entity?";
  coolQuestions[43] = "Have you ever witnessed lights flickering or electronics behaving erratically, suggesting the presence of an unseen entity?";
  coolQuestions[44] = "Can you describe a personal experience where you had a premonition or a strong gut feeling that guided you to make a significant decision?";
  coolQuestions[45] = "Have you ever encountered an area or location that gave you an overwhelming sense of unease?";
  coolQuestions[46] = "Can you recall a time when you experienced a temporary loss of time or memory, as if something inexplicable occurred during that period?";
  coolQuestions[47] = "Have you ever witnessed objects or furniture moving on their own accord, seemingly influenced by an external force?";
  coolQuestions[48] = "Can you describe a moment when you saw an apparition that appeared and disappeared without any logical explanation?";
  coolQuestions[49] = "Have you ever encountered strange symbols or markings that seemed to possess a deeper meaning or conveyed a hidden message?";
  coolQuestions[50] = "Can you recall a time when you felt a sudden surge of energy or a tingling sensation, as if being in the presence of a powerful force?";
  coolQuestions[51] = "Have you ever experienced a recurring dream or nightmare that seemed to have a profound impact on your waking life or emotions?";
  coolQuestions[52] = "Can you describe a personal experience where you felt a deep connection or communication with a deceased loved one, even though they were no longer physically present?";
  coolQuestions[53] = "Have you ever experienced a moment where reality seemed to peel away like layers of a rotten onion, revealing a deeper truth?";
  coolQuestions[54] = "Can you describe the sound of your own thoughts echoing through the corridors of your mind, colliding with the jagged edges of your subconscious?";
  coolQuestions[55] = "If you could rearrange the fragmented pieces of your memories, what haunting images and forgotten fragments would emerge?";
  coolQuestions[56] = "Have you ever encountered a moment where language itself seemed to twist and contort, becoming an incomprehensible labyrinth of whispers and hisses?";
  coolQuestions[57] = "Can you recall a time when you found yourself trapped in the liminal space between dreams and wakefulness, where the familiar became grotesque?";
  coolQuestions[58] = "If you were to decode the cryptic messages embedded within the static noise of everyday life, what dark secrets and hidden truths would be unveiled?";
  coolQuestions[59] = "Have you ever felt the spectral presence of a virus coursing through your veins, infecting your thoughts and altering your perception of reality?";
  coolQuestions[60] = "Can you describe the peculiar dance of shadows that unfolds beneath the flickering streetlights, revealing glimpses of hidden dimensions?";
  coolQuestions[61] = "Can you describe the scent of the city at night, a heady mix of decay, desire, and the lingering aura of forbidden secrets?";
  coolQuestions[62] = "What subversive narratives and subliminal messages would be unleashed upon the world?";
  coolQuestions[63] = "Have you ever encountered a sinister corporation with tentacles stretching across dimensions, manipulating the very fabric of existence for their own nefarious purposes?";
  coolQuestions[64] = "Can you recall a time when your dreams merged with the waking world, blurring the boundaries between reality and the hallucinatory landscapes of your subconscious?";
  coolQuestions[65] = "What incantations and invocations do you whisper into the void?";
  coolQuestions[66] = "Can you describe the feeling of hurtling through time and space, witnessing the twisted evolution of humanity?";
  coolQuestions[67] = "Okay, just one more question, sir.";
  coolQuestions[68] = "Have you ever had the unsettling feeling of being trapped in an endless maze of identical rooms?";
  coolQuestions[69] = "Can you describe the sensation an the ever-present hum that seems to emanate from an unknown source?";
  coolQuestions[70] = "Have you ever encountered a peculiar entity?";
  coolQuestions[71] = "Can you recall a moment when you found yourself surrounded by flickering fluorescent lights and the distinct smell of stale, stagnant air?";
  coolQuestions[72] = "Can you describe the eerie calmness that settles in when time seems to lose its meaning and the passage of hours becomes indistinguishable?";
  coolQuestions[73] = "Have you ever encountered the unsettling sense that someone or something is watching you from a dark corner?";
  coolQuestions[74] = "Can you recall a time when you found yourself longing for an exit, desperately searching for a way out of an seemingly never-ending maze?";
  coolQuestions[75] = "Have you ever experienced a moment of déjà vu?";
  coolQuestions[76] = "Can you recall a time when you discovered a door which left you disoriented and uncertain of your location?";
  coolQuestions[77] = "How would you navigate this encounter?";
  
  
}

String getCoolQuestion()
{
  return coolQuestions[Random(77)];
  
}

function clearSpeechBubble()
{
  if(speechBubble != null)
  {    
    if(speechBubble.Valid)
    {
      speechBubble.Remove();       
    }
  }
}

function placeDistance(int atX)
{
  oDistance.X = atX; // - 60;
  oSunset.X = atX; // - 60;
  oNight.X = atX;
}

function findCameraPositionAfterCharacterChange()
{ 
  characterChange = false;
  switch(Find.findPlayer())
  {
    case 1:
      Game.Camera.SetAt(306, 0);
      placeDistance(306);
      
    break;
    case 2:
      Game.Camera.SetAt(524, 0);
      placeDistance(524);
      
    break;
    case 3:
      Game.Camera.SetAt(707, 0);
      placeDistance(707);
      
    break;
    default:
      Game.Camera.SetAt(306, 0);
      placeDistance(306);
      
    break;        
  }
}

function findCameraPosition()
{
  if(player.PreviousRoom == eRooms_Omni_CorridorLeft)
  {
    Game.Camera.SetAt(0, 0);
    placeDistance(0);
    
  } else if (player.PreviousRoom == eRooms_Omni_CorridorRight)
  {
    Game.Camera.SetAt(925, 0);
    placeDistance(925);
    
  } else {
    findCameraPositionAfterCharacterChange();
    
  }
}

function isCharHere(String theName)
{  
  for (int i = 0; i < Game.CharacterCount - 1; i++)
  {
    if(character[i].Name == theName && character[i].Room == eRooms_Omni_CallCentre)
    {
      return true;
    }
  }
  return false;
}

int getUserID(String theName)
{
  for (int i = 0; i < Game.CharacterCount; i++)
  {
    if(character[i].Name == theName)
    {
      return character[i].ID;
    }
  }
}

function setupComp(Object* theComp)
{  
  theComp.Visible = true;
  theComp.Baseline = 148;
  theComp.SetView(111, Random(1), Random(10));
  theComp.Animate(Random(1), 4, eRepeat, eNoBlock, eForwards);
  
  if(!isCharHere(theComp.GetTextProperty("user")))
  {
    theComp.Visible = false;
  } else {
    if(character[getUserID(theComp.GetTextProperty("user"))].GetProperty("strolling"))
    {
      theComp.Visible = false;
    } else {
      theComp.Visible = true;
    }
  }
}

function hideComp(Object* theComp)
{
  theComp.Visible = false;
}

function setupComps()
{
    setupComp(comp1);
    setupComp(comp2);
    setupComp(comp3);
    setupComp(comp4);
    setupComp(comp5);
   // setupComp(comp6);
    setupComp(comp7);
    setupComp(comp8);
    setupComp(comp9);
}


function turnOnLightsLoad()
{
  if(Time.isItBetweenTheseHours(6, 21))
  {
    SetBackgroundFrame(0);
  } else {
    SetBackgroundFrame(1);
  }
}

function turnOnLightsRepExec()
{
  if(Time.atTimeOfDay(6, 0))
  {
    SetBackgroundFrame(0);
  }
  if(Time.atTimeOfDay(21, 0))
  {
    SetBackgroundFrame(1);
  }
}

function prevRoomConditions()
{
  switch(player.PreviousRoom)
  {
    case eRooms_Omni_CorridorLeft:
     
    break;
    case eRooms_Omni_CorridorRight:
    
    break;  
    case eRooms_Omni_Computer:
    oAbisChair.Visible = true;
    player.UnlockView();
    break;
  }
}


function parallaxDistance(int toX,  int fromX)
{
  float timing  = 1.0;
  if(!IsPlayerAbi && skippingWalking)
  {
    timing = 0.5;
  }
  /*
  int parallaxOffset = 30;
  int difference = toX - fromX;
  int distanceOldX = oDistance.X;
  int theDestination;
  
  if(toX < fromX) //camera going left
  {
    theDestination = distanceOldX + difference + parallaxOffset;
  } else { //camera going right
    theDestination = distanceOldX + difference - parallaxOffset;
  }*/
  int theDestination = toX;
  oDistance.StopAllTweens(ePauseTween);
  oSunset.StopAllTweens(ePauseTween);
  oSunset.TweenX(timing, theDestination, eEaseInOutSineTween, eNoBlockTween);
  oDistance.TweenX(timing, theDestination, eEaseInOutSineTween, eNoBlockTween);
  oNight.StopAllTweens(ePauseTween);
  oNight.TweenX(timing, theDestination, eEaseInOutSineTween, eNoBlockTween);
}

function scrollTheRoom(int toX)
{
  float timing = 1.0;
  if(!IsPlayerAbi && skippingWalking)
  {
    timing = 0.5;
  }
  SetTimerWithSeconds(16, timing + 0.5);
  clearSpeechBubble();
  askProcess = 0;
  int fromX = Game.Camera.X;
  Game.Camera.StopAllTweens(ePauseTween);
  Game.Camera.TweenX(timing, toX, eEaseInOutSineTween, eNoBlockTween);
  parallaxDistance(toX, fromX);
}




function room_AfterFadeIn()
{
  if(player.PreviousRoom == eRooms_Omni_CorridorLeft)
  {
    
    scrollTheRoom(306);
    
    
    player.Walk(1009, player.y, eNoBlock);
  } else if (player.PreviousRoom == eRooms_Omni_CorridorRight)
  {
    scrollTheRoom(707);
      
    player.Walk(326, player.y, eNoBlock);
  }
  if(Time.isItBetweenTheseHours(9, 17))
  {
    if(player.PreviousRoom != eRooms_Omni_Computer)
    {
      aMuffledVoices.Play(eAudioPriorityHigh, eRepeat);
    }
  }
}

/****************Scrolling Stuff******************************************************************/

int wasHere = 0;

function region2_WalksOff()
{
  wasHere = 2;
}

function region2_WalksOnto()
{
  if(wasHere == 3)
  {
    scrollTheRoom(306);
       

    wasHere = 0;
  }
}

function region3_WalksOff()
{
  wasHere = 3;
}

function region3_WalksOnto()
{
  if(wasHere == 2)
  {
    scrollTheRoom(524);
     
    wasHere = 0;
  }
}

function region4_WalksOff()
{
  wasHere = 4;
}

function region4_WalksOnto()
{
  if(wasHere == 5)
  {
    
    scrollTheRoom(524);
    
    wasHere = 0;
  }  
}

function region5_WalksOff()
{
  wasHere = 5;
}

function region5_WalksOnto()
{
  if(wasHere == 4)
  {
    scrollTheRoom(707);
    
    wasHere = 0;
  }
}

/******************Change Rooms***********************************************************************/


function region1_WalksOnto()
{
  player.ChangeRoom(eRooms_Omni_CorridorLeft, player.x + 250, player.y);
}

function region6_WalksOnto()
{
  player.ChangeRoom(eRooms_Omni_CorridorRight, player.x - 707, player.y);
}

/**************************INTERACTION ***********************************************************/

function hHall2_AnyClick()
{

switch (verbUsed)
{
  case 0: //walk
    player.GoTo(1030, 174);    
  break;
  case 1://look
    player.FaceDirection(eDirectionRight);
    lookAbiPaul("More hallway through there.", 
                "This place is endless!");
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    Canned.noMoving();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;

}

function hHall1_AnyClick()
{

switch (verbUsed)
{
  case 0: //walk
    player.GoTo(322, 171);    
  break;
  case 1://look
    player.FaceDirection(eDirectionLeft);
    lookAbiPaul("More hallway through there.", 
                "This place is endless!");
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    Canned.noMoving();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;

}

function computerInteraction(Object* theComp)
{
  int x = theComp.GetProperty("XX");
  int y = theComp.GetProperty("YY");
  String toSay;

  switch (verbUsed)
  {
    case 0: //walk
      walkToAndFace(x, y, eDirectionUp, x + 10, y + 10);    
    break;
    case 1://look
      player.FaceLocation(x, y - 10, eBlock);
      
      if(IsPlayerAbi)
      {
        toSay = String.Format("It's %s computer.", theComp.GetTextProperty("occupant"));
      } else {
        toSay = "I dunno, someone's computer.";
      }
      
      player.Say(toSay);
    break;
    case 2://use
      Canned.noUsing();
    break;
    case 3://talk
      Canned.noTalking();
    break;
    case 4://move
      Canned.noMoving();
    break;
    case 5://fourletters
      Canned.fuckAnyone();
    break;
    case 6://take
      Canned.cantTake();
    break;
    case 7://inv
      Canned.wontWork();
    break;
  }
  verbUsed = 0;
  
  
}

function comp1_AnyClick(){  computerInteraction(comp1); }
function comp2_AnyClick(){  computerInteraction(comp2); }
function comp3_AnyClick(){  computerInteraction(comp3); }
function comp4_AnyClick(){  computerInteraction(comp4); }
function comp5_AnyClick(){  computerInteraction(comp5); }
function comp6_AnyClick(){  computerInteraction(comp6); }
function comp7_AnyClick(){  computerInteraction(comp7); }
function comp9_AnyClick(){  computerInteraction(comp9); }
function comp8_AnyClick(){  computerInteraction(comp8); }

/*****************************Moving NPCS*****************************************************/

function sendOneCharHome(Character* theChar)
{
  if(Time.atTimeOfDay(Employees_Omni.getDeparture(true, theChar), 
                      Employees_Omni.getDeparture(false, theChar)))
  {    
    theChar.SetProperty("strolling",true);
  }
}

function sendCharHome()
{
  sendOneCharHome(cBob);
  sendOneCharHome(cSally);
  sendOneCharHome(cFred);
  sendOneCharHome(cMatt);
  sendOneCharHome(cFrank);
  sendOneCharHome(cDennis); 
  sendOneCharHome(cKirsty); 
  sendOneCharHome(cGina); 
  sendOneCharHome(cClaudia); 
  sendOneCharHome(cFiona); 
  sendOneCharHome(cMia); 
  sendOneCharHome(cHelen); 
  sendOneCharHome(cRachel); 
  sendOneCharHome(cSeema); 
  sendOneCharHome(cAria); 
  sendOneCharHome(cAimee); 
  sendOneCharHome(cStuart); 
}

function moveStaff(Character* theChar)
{
  //theChar.SayBackground(String.Format("%d",theChar.SCABS()));
  if(theChar.Room == eRooms_Omni_CallCentre)
  {
    switch(theChar.SCABS())
    {
      case 0:
        if(theChar.Room == eRooms_Omni_CallCentre)
        {
          if(theChar.GetProperty("strolling"))
          {
            if(Time.hasThisHourPassed(12))
            {
              theChar.SCABS(9);
            } else {
              theChar.SCABS(50);
            }
          }
        }      
      break;
      ////////////////////////////////////////////
      case 9:
        if(theChar.GetProperty("locale"))
        {
          hideComp(object[theChar.GetProperty("locale")]);
          if(theChar.delay(0.6))
          {
            
            theChar.SCABS(1);
          }
        } else {
          theChar.SCABS(1);
        }
      break;
      case 10: //going home
        //animate getting up from computer
        theChar.Baseline = -1;        
        theChar.ChangeView(theChar.GetProperty("normalWalkView"));
        theChar.SetIdleView(-1, 5);
        theChar.SCABS(1);
      break;
      case 11:
        if(theChar.y < 140)
        {
          theChar.SCABS(15);
        } else {
          theChar.SCABS(30);
        }
      break;
      ////////////////////////////////////////////
      case 15: //top row
        theChar.SCABSwalk(theChar.x, 119, 1, eAnywhere);
      break;
      case 16:
        theChar.SCABSwalk(1009, 119);
      break;
      case 17:
        theChar.SCABSwalk(974, 175);
      break;
      case 18:
        if(!theChar.Moving && !theChar.isAt(1010, 177))
        {
          theChar.Walk(1010, 177);
        } else if (theChar.x > 993)
        {
          theChar.TweenTransparency(0.4, 100, eEaseInOutSineTween, eNoBlockTween);
          theChar.SCABS(1);
        }            
      break;
      case 19:
        if(!theChar.Moving && !theChar.x < 1018)
        {
          theChar.Walk(1030, 177, eNoBlock, eAnywhere);
        } else if (theChar.Transparency == 100)
        {
          theChar.SCABS(1);
        }
      break;
      case 20:
        theChar.ChangeRoom(eRooms_Omni_CorridorRight, theChar.x - 707, theChar.y);
        theChar.SCABS(0); 
      break;
      
      ////////////////////////////////////////////
      
      case 30: //staff in lower row
      //getting up animation
        theChar.SCABS(1);
      break;
      case 31:
        //this looks fucked sean
        theChar.SCABSwalk(theChar.x, 177, 1, eAnywhere);
      break;
      case 32:
        if(!theChar.Moving)
        {
          theChar.Walk(1034, 177, eNoBlock, eAnywhere);
        } 
        if(theChar.x > 985)
        {
          theChar.TweenTransparency(0.5, 100, eEaseInOutSineTween, eNoBlockTween);
          theChar.SCABS(1);
        }          
      break;
      case 33:
      
        if(!theChar.Moving && !theChar.Transparency < 100)
        {
          theChar.Walk(1044, 177, eNoBlock, eAnywhere);
        } else if(theChar.Transparency == 100)
        {
          theChar.SCABS(1);
        }
      break;
      case 34:
        theChar.ChangeRoom(eRooms_Omni_CorridorRight, theChar.x - 707, theChar.y); 
        theChar.SCABS(0);
      break;
      
      /////////////////////////////////////////////
      case 50: //arrival at office
        if(theChar.x > 970)
        {
          
          theChar.Transparency = 100;
          theChar.TweenTransparency(0.5, 0, eEaseInOutSineTween, eNoBlockTween);         
        }
        if(Employees_Omni.findY(theChar) > 139)
        {          
          theChar.SCABS(60);
        } else {                  
          theChar.SCABS(80);
        }
      break;
      
      /////////////////////////////////////////////
      
      case 60: //arrive, in bottom row
        theChar.SCABSwalk(Employees_Omni.findX(theChar), theChar.y);
      break;
      case 61:
        theChar.SCABSwalk(Employees_Omni.findX(theChar), Employees_Omni.findY(theChar), 1, eAnywhere);        
      break;
      case 62:
        theChar.SetProperty("strolling", false);
        theChar.ChangeView(theChar.GetProperty("normalSitView"));   
        theChar.SetIdleView(theChar.GetProperty("idleView"), 4+Random(4));
        theChar.SCABS(1);
      break;
      case 63:
        if(theChar.delay(0.5))
        {
          if(theChar.GetProperty("locale"))
          {
            setupComp(object[theChar.GetProperty("locale")]);
          }
          theChar.SCABS(0);
        }
      break;
      
      /////////////////////////////////////////////
      
      case 80: //arrive, in top row 
        if(theChar.y > 145)
        {
          theChar.SCABSwalk(972, 175);
        } else {
          theChar.SCABS(1);
        }
      break;
      case 81:      
        theChar.SCABSwalk(1018, 118);
      break;
      case 82:      
        theChar.SCABSwalk(Employees_Omni.findX(theChar), 118);
      break;
      case 83:      
        theChar.SCABSwalk(Employees_Omni.findX(theChar), Employees_Omni.findY(theChar), 1, eAnywhere);
      break;
      case 84:        
        theChar.SetProperty("strolling", false);
        theChar.ChangeView(theChar.GetProperty("normalSitView")); 
        theChar.Baseline = theChar.GetProperty("baseline");
        theChar.SCABS(0);
      break;
      default:
        theChar.SCABS(0);
      break;
    }      
  }
}

/*****************************Question Generator**********************************************/

int clauseOneType;
String makeFirstCause()
{
  String clause;
   
  switch(clauseOneType)
  {
    case 0:        
      switch(Random(1))
      {
        case 0:
        clause = "Have ";
        break;
        case 1:
        clause = "Haven't ";
        break;       
      }
    break;
    case 1:
      switch(Random(2))
      {
        case 0:
        clause = "When ";
        break;
        case 1:
        clause = "How ";
        break;   
        case 2:
        clause = "";
        break;
        
      }  
    break;
  }
  return clause;
}

String makeSecondClause()
{
  String clause;
  switch(clauseOneType)
  {
    case 0:
      switch(Random(1))
      {
        case 0:
        clause = "you ever experienced";
        break;
        case 1:
        clause = "you noticed";
        break; 
      }
    break;
    case 1:
    switch(Random(3))
      {
        case 0:
        clause = "was the last time";
        break;
        case 1:
        clause = "did you notice";
        break;    
        case 2:
        clause = "is it possible";
        break;
        case 3:
        clause = "many times";
        break;
      }
    break;
  }
  return clause;  
}
String makeThirdClause()
{
  String clause;
  switch(Random(8))
  {
    case 0:
    clause = "cats";
    break;
    case 1:
    clause = "windows";
    break;
    case 2:
    clause = "beans";
    break;
    case 3:
    clause = "fish";
    break;
    case 4:
    clause = "eyes";
    break;
    case 5:
    clause = "strangers";
    break;
    case 6:
    clause = "your parents";
    break;
    case 7:
    clause = "your best friends";
    break;
    case 8:
    clause = "your nanna and poppa";
    break;
  }
  return clause;
}

String makeForthClause()
{
  String clause;
  switch(clauseOneType)
  {
    case 0:
      switch(Random(5))
      {
        case 0:
        clause = "falling from";
        break;
        case 1:
        clause = "due to";
        break;    
        case 2:
        clause = "climbing into";
        break;
        case 3:
        clause = "cascading from";
        break;
        case 4:
        clause = "pouring over";
        break;
        case 5:
        clause = "eating all of";
        break;
      }
    break;
    case 1:
      switch(Random(3))
      {
        case 0:
        clause = "were seen inside";
        break;
        case 1:
        clause = "have been climbing into";
        break; 
        case 2:
        clause = "were talking about";
        break;
        case 3:
        clause = "going away to";
        break;
      }
    break;
  }
  return clause;  
}

String makeFifthClause()
{
  String clause;
  switch(Random(12))
  {
    case 0:
    clause = "the sky";
    break;
    case 1:
    clause = "your mouth";
    break;
    case 2:
    clause = "the post-box";
    break;
    case 3:
    clause = "the sound of my voice";
    break;
    case 4:
    clause = "the glowing vortex";
    break;
    case 5:
    clause = "the disappointing way your life has turned out";
    break;
    case 6:
    clause = "the excitement of a new day";
    break;
    case 7:
    clause = "a lonely heron";
    break;
    case 8:
    clause = "a vigorous pigeon";
    break;
    case 9:
    clause = "a lovely holiday";
    break;
    case 10:
    clause = "the tea kettle";
    break;
    case 11:
    clause = "the gallery";
    break;
    case 12:
    clause = "a really trendy party";
    break;
  }
  return clause;  
}
String makeSentence()
{
   /* clauseOneType = Random(1);

  String sentence =  String.Format("%s%s %s %s %s?", makeFirstCause(), makeSecondClause(), makeThirdClause(), 
  makeForthClause(), makeFifthClause());
  
  return HandyHelper.capitaliseSentence(sentence);
  */
  return getCoolQuestion();
}

bool toComputerRoom = false;

function room_Leave()
{
  if(!toComputerRoom)
  {  
    aMuffledVoices.Stop();
  }

}
 
int wheresCamera()
{
  if(Game.Camera.X == 306)
  {
    return 1;
  } else if (Game.Camera.X == 524)
  {
    return 2;
  } else if (Game.Camera.X == 707)
  {
    return 3;
  } else {
    return 0;
  }
}
 
Character* talkingChar;
function chooseCharacter()
{  
  
  switch(wheresCamera())
  {
    case 0:
      talkingChar = cGhostl;
    break;
    case 1:
      switch(Random(7))
      {
        case 0:   
          if(cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 1:
          if(cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          }  else if (cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }           
        break;
        case 2:
          if(cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }   
        break;
        case 3:
          if(cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if(cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }   
        break;
        case 4:
          if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 5:
          if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else  if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 6:
          if(cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else  if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 7:
          if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else  if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cKirsty.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cKirsty;
          } else if (cMatt.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMatt;
          } else if (cBob.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFred;
          } else if (cFred.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cBob;
          } else {
            talkingChar = cGhostl;
          }
        break;
      }   
    break;    
    case 2:      
      switch(Random(8))
      {
        case 0:
          if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 1:
          if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 2:
          if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;            
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;        
        case 3:
          if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 4:
          if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 5:
          if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 6:
          if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 7:
          if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else {
            talkingChar = cGhostl;          
          }
        break;
        case 8:
          if(cAria.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAria;
          } else if(cSeema.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSeema;
          } else if(cRachel.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cRachel;
          } else if (cHelen.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cHelen;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if (cGina.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cGina;
          } else if (cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else {
            talkingChar = cGhostl;          
          }
        break;
      }
    return true;
    break;
    case 3:
      switch(Random(7))
      {
        case 0:
          if(cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if (cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 1:
           if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if (cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 2:
          if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 3:
          if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 4:
          if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 5:
          if(cAria.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAria;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 6:
          if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cAria.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAria;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else {
            talkingChar = cGhostl;
          }
        break;
        case 7:
          if(cStuart.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cStuart;
          } else if(cAimee.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAimee;
          } else if(cAria.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cAria;
          } else if(cMia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cMia;
          } else if(cClaudia.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cClaudia;
          } else if(cDennis.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cDennis;
          } else if(cFrank.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cFrank;
          } else if (cSally.Room == eRooms_Omni_CallCentre)
          {
            talkingChar = cSally;
          } else {
            talkingChar = cGhostl;
          }
        break;
      }
     
    //return true;
    break;    
  }  
}
 
 


function askQuestion()
{    
  if(Time.isItBetweenTheseHours(9, 17))
  {
      if(!IsGamePaused())
      {
      switch(askProcess)
      {
        case 0:
          if(HandyHelper.roomDelay(timeToAsk))
          {      
            askProcess++;
          }
        break;
        case 1:
          //warning this block may be infinitely recursive
          chooseCharacter();  
          if(talkingChar != cGhostl)
          {
            askProcess++;              
          } else {
            askProcess = 69;
          }
        break;
        case 2:
          if(talkingChar.GetProperty("strolling"))
          {
            askProcess = 69;
          } else {
            talkingChar.LockView(talkingChar.GetProperty("normalSpeechView"), eStopMoving);
            talkingChar.Animate(0, 2, eRepeat, eNoBlock, eForwards);
            Game.SpeechFont = eFontTinyText;
            speechBubble = talkingChar.SayBackground(makeSentence());      
            Game.SpeechFont = eFontSpeech; 
            timeToAsk = IntToFloat(2 + Random(8));
            askProcess++;
          }
        break;
        case 3:    
            if(HandyHelper.roomDelay(3.4)) 
            {                  
              talkingChar.UnlockView(eStopMoving);
              clearSpeechBubble();         
              askProcess = 0; 
            }                          
        break;
        case 69:
          //free parking
        break;
      }
    } else {
      clearSpeechBubble();
    }
  }
}

function johnGoHome()
{
  John.johnDepart();
  John.johnArrive();
  if(cJohn.Room == eRooms_Omni_CallCentre)
  {
    if(!cJohn.Moving)
    {
      if(Time.hasThisHourPassed(12))
      {
        if(cJohn.x < Room.RightEdge)
        {
          cJohn.Walk(Room.RightEdge, cJohn.y);
          //cJohn.Transparency = 100;
          cJohn.TweenTransparency(0.5, 0,  eEaseInOutSineTween, eNoBlockTween);
        } else if ( cJohn.Transparency == 0)
        {
          cJohn.Walk(Room.RightEdge + 30, cJohn.y, eNoBlock, eAnywhere);
          
          cJohn.TweenTransparency(0.8, 100, eEaseInOutSineTween, eNoBlockTween);
          
        }
        if (cJohn.x > Room.RightEdge  && cJohn.Transparency > 90)
        {
         
          cJohn.ChangeRoom(eRooms_Omni_CorridorRight, 283 + cJohn.x - Room.RightEdge, cJohn.y);
          cJohn.Transparency = 0;
        }
      } else {
        if(!cJohn.Moving && cJohn.x > 315)
        {
          cJohn.Walk(315, 177);
        }                  
        if(cJohn.Transparency == 100)
        {
          cJohn.TweenTransparency(0.8, 0, eEaseInOutSineTween, eNoBlockTween);
        }          
        if(cJohn.isAt(315, 177))
        {
          cJohn.ChangeRoom(eRooms_Omni_CorridorLeft, cJohn.x + 250, 171);          
        }
        
      }
    }
  }
}

function muffledVoiceStartStops()
{
  if(Time.atTimeOfDay(9, 0))
  {
    aMuffledVoices.Play(eAudioPriorityHigh, eRepeat);
  }
  
  if(Time.atTimeOfDay(5, 01))
  {
    aMuffledVoices.Stop();
  }
}

function room_RepExec()
{
  
  moveStaff(cBob);
  moveStaff(cFred);
  moveStaff(cSally);
  moveStaff(cMatt);
  moveStaff(cFrank);
  moveStaff(cDennis);
  moveStaff(cKirsty);
  moveStaff(cGina);
  moveStaff(cClaudia);
  moveStaff(cFiona);
  moveStaff(cMia);
  moveStaff(cHelen);
  moveStaff(cRachel);
  moveStaff(cSeema);
  moveStaff(cAria);
  moveStaff(cAimee);
  moveStaff(cStuart);
  sendCharHome();
  
  Employees_Omni.staffArrive();
  //toggleComps();
  Hamish.arrive();
  
  
  Time.changeSky(oDistance, oSunset, oNight);  
  turnOnLightsRepExec();
  askQuestion();

  johnGoHome();
  
  
  cJohn.moveInOtherRoom(eRooms_Omni_CorridorLeft, 454, 
        eRooms_Omni_HR, 592, eRooms_Omni_CallCentre, 10, 10, 321, 171);
  cJohn.moveInOtherRoom(eRooms_Omni_CorridorRight, 281, 
        eRooms_Omni_CallCentre, 781, eRooms_SpookyZone, 1006, 171, 10, 10);    
  Employees_Omni.MoveInCorridor(cBob);
  Employees_Omni.MoveInCorridor(cFred);
  Employees_Omni.MoveInCorridor(cSally);  
  Employees_Omni.MoveInCorridor(cMatt);  
  Employees_Omni.MoveInCorridor(cFrank);  
  Employees_Omni.MoveInCorridor(cDennis);  
  Employees_Omni.MoveInCorridor(cKirsty);  
  Employees_Omni.MoveInCorridor(cGina);  
  Employees_Omni.MoveInCorridor(cClaudia);  
  Employees_Omni.MoveInCorridor(cFiona);  
  Employees_Omni.MoveInCorridor(cMia);  
  Employees_Omni.MoveInCorridor(cHelen);  
  Employees_Omni.MoveInCorridor(cRachel);  
  Employees_Omni.MoveInCorridor(cSeema);  
  Employees_Omni.MoveInCorridor(cAria);  
  Employees_Omni.MoveInCorridor(cAimee);  
  Employees_Omni.MoveInCorridor(cStuart);  
}

function room_FirstLoad()
{
  popCoolQuestions();
}

function placeStaff(Character* theChar)
{
  if(theChar.Room == eRooms_Omni_CallCentre && !theChar.GetProperty("strolling"))
  {
    theChar.place(Employees_Omni.findX(theChar), Employees_Omni.findY(theChar));
    theChar.ChangeView(theChar.GetProperty("normalSitView"));
    theChar.Baseline = theChar.GetProperty("baseline");
    theChar.SetIdleView(theChar.GetProperty("idleView"), 4+Random(4));
    theChar.Loop = 0;
    theChar.Transparency = 0;
    if(Employees_Omni.findY(theChar) > 139)
    {
      setupComp(object[theChar.GetProperty("locale")]);
    }
  }  
}
function placeStaffInChairs()
{  
  placeStaff(cBob);
  placeStaff(cSally);
  placeStaff(cFred);
  placeStaff(cMatt);
  placeStaff(cFrank);
  placeStaff(cDennis);
  placeStaff(cKirsty);
  placeStaff(cGina);
  placeStaff(cClaudia);
  placeStaff(cFiona);
  placeStaff(cMia);
  placeStaff(cHelen);
  placeStaff(cRachel);
  placeStaff(cSeema);
  placeStaff(cAria);
  placeStaff(cAimee);
  placeStaff(cStuart);
}

function room_Load()
{
  Computer.getabiScreen();
  toComputerRoom = false;
  resumeMusicAfterCHCH(aEndlessOffice);  
  changePlayerLocaleOnRoomEnter();  
  if(characterChange)
  {
    Employees_Omni.putCharsInPlace();
    characterChange = false;
  }
  if(Computer.isKeyTaken())
  {
    oKeyPropSmall.Visible = false;
  } else {
    oKeyPropSmall.Visible = true;
  }
  
  timeToAsk = 2.0;
  HandyHelper.resetRoomDelay();  
  setupComps();  
  prevRoomConditions();  
  turnOnLightsLoad();  
  timeToAsk = 2.0;
  askProcess = 0; 
  findCameraPosition(); 
  placeStaffInChairs(); 
  Time.setSky(oSunset, oNight, oDistance);  
}


function skyInteract(String abiSay, String paulSay)
{
  
  switch (verbUsed)
  {
    case 0: //walk
      walkToAndFace(Game.Camera.X+mouse.x, 119, eDirectionUp, Game.Camera.X+mouse.x + 15, 119);       
    break;
    case 1://look
      player.FaceLocation(Game.Camera.X + mouse.x, Game.Camera.Y + mouse.y, eBlock);
      lookAbiPaul(abiSay, paulSay);
    break;
    case 2://use
      Canned.noUsing();
    break;
    case 3://talk
      Canned.noTalking();
    break;
    case 4://move
      Canned.noMoving();
    break;
    case 5://fourletters
      Canned.fuckAnyone();
    break;
    case 6://take
      Canned.cantTake();
    break;
    case 7://inv
      Canned.wontWork();
    break;
  }
  verbUsed = 0;

}
function oNight_AnyClick()
{  
  skyInteract("It's a night time.", "The velvet coat of night has enveloped us all.");
}

function oSunset_AnyClick()
{
  skyInteract("Nearly night-time.", "What a glorious sunset!");
}

function oDistance_AnyClick()
{
  skyInteract("It's a fine day.", "It's a grey, bleak day.");
}



function hBarbaraStation_AnyClick(){  computerInteraction(comp8); }
function hFrankStation_AnyClick(){  computerInteraction(comp9); }
function hMiaStation_AnyClick(){  computerInteraction(comp7); }

function hFionaStation_AnyClick(){  computerInteraction(comp5); }
function hRachelStation_AnyClick(){  computerInteraction(comp4); }
function hKirstyStatino_AnyClick(){  computerInteraction(comp3); }
function hMattStation_AnyClick(){  computerInteraction(comp2); }
function hBrianStation_AnyClick(){  computerInteraction(comp1); }


function hAbiStation_AnyClick()
{ 

  switch (verbUsed)
  {
    case 0: //walk
      walkToAndFace(757, 165, eDirectionUp, 740, 183); 
   
    break;
    case 1://look
      player.FaceLocation(756, 144, eBlock);
      lookAbiPaul("It was my old workstation.", 
                  "It's someone's depressing cubicle.");
    break;
    case 2://use
      toComputerRoom = true;
      StartCutscene(eSkipESCOnly);
      player.Walk(757, 165, eBlock);
      player.FaceDirection(eDirectionUp, eBlock);
      player.LockView(199);
      oAbisChair.Visible = false;
      player.Animate(0, 2, eOnce, eBlock, eForwards);
      EndCutscene();
      player.ChangeRoom(eRooms_Omni_Computer);
    break;
    case 3://talk
      Canned.noTalking();
    break;
    case 4://move
      Canned.noMoving();
    break;
    case 5://fourletters
      Canned.fuckAnyone();
    break;
    case 6://take
      Canned.cantTake();
    break;
    case 7://inv
      Canned.wontWork();
    break;
  }
  verbUsed = 0;

}