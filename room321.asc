// room script file

int blinkDuration  = 8;
int blinkCounter = 0;
bool blinkingAllowed = false;
int dryEyes = 40;
function llBlink()
{
  if(blinkingAllowed)
  {
    blinkCounter++;
    if(blinkCounter == dryEyes)
    {
      
      oLandBlink.Visible = true;
    } else if (blinkCounter == dryEyes + blinkDuration)
    {
      oLandBlink.Visible = false;
      dryEyes = 30 + Random(60);
      blinkCounter = 0;     
    }
  }
}

function stopLandBlink()
{
  blinkingAllowed = false;
 oLandBlink.Visible = false;
}


function paulSpeak(String paulSaid)
{
   cUPaulSideShot.SayAtSync(120, 100, 120, paulSaid);  
}


function room_Load()
{
  if(cutSceneShot ==10)
  {
  cLandLordSide.Loop = 0;
  } else {
    cLandLordSide.Loop = 1;
    oEyeSHut.Visible = false;
  }
}

function landLordTalk(String theString)
{    
  cLandLordSide.SayAtSync(200 , 20,80,  theString);
}


function abiSpeak(String abiSays)
{
   cAbiCSide.SayAtSync(45, 23, 140, abiSays);
}

function shot1()
{

   landLordTalk("&7 Oh, righto.");
   
   oEyeSHut.Visible = false;
   Wait(1);

   cLandLordSide.LockView(224);
   cLandLordSide.Animate(0, 2, eOnce, eNoBlock, eForwards, 0);
   
   abiSpeak("&41 What's this about?");
   cLandLordSide.UnlockView(eStopMoving);
   cLandLordSide.Loop = 1;
   landLordTalk("&8 Well uh,");
  

   player.ChangeRoom(27);
}

function shot2()
{
  blinkingAllowed = true;
   abiSpeak("&42 Not the yacht!");
    abiSpeak("&43 How will you do all your human trafficking?");
    oLandBrow.Visible = true;
    landLordTalk("&15 No, no,");
    oLandBrow.Visible = false;
    player.ChangeRoom(27);
    //oh no nt the yacht.. etc
}

function shot3()
{
  blinkingAllowed = true;
  abiSpeak("&44 Last time we saw him he...");
  abiSpeak("&45 He...");
  stopLandBlink();
  cLandLordSide.LockView(224, eStopMoving);
  cLandLordSide.Animate(2, 2, eOnce, eNoBlock);
  paulSpeak("&23 He went through the weird door.");
  cLandLordSide.UnlockView(eStopMoving);
  cLandLordSide.Loop = 0;
  landLordTalk("&19 Ah yup, which one's the weird door?");
}

function room_AfterFadeIn()
{
  if(cutSceneShot == 10)
  {
    shot1();
  } else if (cutSceneShot == 12)
  {
    shot2();
  } else if (cutSceneShot == 13)
  {
    shot3();
  }
}


function late_repeatedly_execute_always()
{
  llBlink();
}