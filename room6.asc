// room script file

function region1_WalksOnto()
{  
  player.ChangeRoom(1, player.x + 180, player.y);
}


function makeReflection(){
cDummy.ChangeRoom(6);
cDummy.ChangeView(player.View);
cDummy.x=104;
cDummy.y=162;
cDummy.Tint(1, 2, 1, 50, 100);
cDummy.Baseline=1;
}

function room_Load()
{
  changePlayerLocaleOnRoomEnter();
  makeReflection();
  adjustPhoneVolumeWhilstRinging();
  resumeMusicAfterCHCH(aFlat_theme);
  if(characterChange)
  {
    characterChange = false; 
  }
  followInThisRoom = false;
}

function room_AfterFadeIn()
{
  if( cAbi.Room == 6 && cPaul.Room == 6 )
  {
    player.Say("What are you doing in here?");
    cPaul.FaceCharacter(cAbi);    
    cPaul.Say("I dunno, hanging out?");
    WaitMouseKey(30);
    player.Say("Oh yeah...");
  }
}
function moveReflection(){
  if(player.x>164)
  {
    int wall_y = 145;
    
    if(player.Speaking)
    {
      cDummy.ChangeView(player.SpeechView);
    } else {
      if(cDummy.View != player.View)
      {
        cDummy.ChangeView(player.View);
      }
    }
    cDummy.y = wall_y - ((player.y-wall_y)*8)/10;  
    cDummy.x = player.x+(player.y-wall_y);
    cDummy.Frame = player.Frame;
    int l = player.Loop;
    if (l==0){l=3;}
      else if(l==3){l=0;}
      else if(l==4){l=5;}
      else if(l==5){l=4;}
      else if(l==6){l=7;}
      else if(l==7){l=6;}
    cDummy.Loop = l;
  }
}

function lookingInMirror(){
  if(inRect(170, 145, 214, 164))
  {
    player.Walk(209, 154, eBlock);
    player.FaceDirection(eDirectionUp, eBlock);
    String playerSayString;
    if(IsPlayerAbi)
    {
      playerSayString = "I'm looking good, considering the circumstances.";
    } else {
      playerSayString = "Hello, stupid face.";
    }
    player.SayAt(player.x - 150, player.y-80, 300,  playerSayString);
   
   // lookAbiPaul("I'm looking good, considering the circumstances.",
     //           "Hello, stupid face.");
  } else {
    lookAbiPaul("It's a mirror.",
                "Classic bathroom mirror.");
  }
}

function late_repeatedly_execute_always()
{
  moveReflection();
  }
function room_RepExec()
{
  
 
}
/********************************HOTSPOTS*************************HOTSPOTS***********************************/
function hToilet_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    walkToAndFace(128, 181, eDirectionLeft, 138, 181);

  break;
  case 1://look  
    sendBeep("test line one","test line two");
    showAbisBeeper();
  break;
  case 2://use
    noUsing();
  break;
  case 3://talk
    noTalking();
  break;
  case 4://move
    noMoving();
  break;
  case 5://fourletters
    player.pooWees();
  break;
  case 6://take
    cantTake();
  break;
  case 7://inv
    lookAbiPaul("No, it'd probably clog the pipes.",
                "This isn't the kind of toilet that flushes stuff through time.");
  break;
}
verbUsed = 0;
}



function hExit_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    player.Walk(138, 196);
  break;
  case 1://look
    lookAbiPaul("That way back to the hall!", "It's the only way in or out of here.");
  break;
  case 2://use
    noUsing();
  break;
  case 3://talk
    noTalking();
  break;
  case 4://move
    noMoving();
  break;
  case 5://fourletters
    fuckAnyone();
  break;
  case 6://take
    cantTake();
  break;
  case 7://inv
    wontWork();
  break;
}
verbUsed = 0;

}

function hMirror_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    walkToAndFace(209, 154, eDirectionUp, 207, 164);      
  break;
  case 1://look
    lookingInMirror();    
  break;
  case 2://use
    noUsing();
  break;
  case 3://talk
    noTalking();
  break;
  case 4://move
    noMoving();
  break;
  case 5://fourletters
    fuckAnyone();
  break;
  case 6://take
    cantTake();
  break;
  case 7://inv
    wontWork();
  break;
}
verbUsed = 0;

}
