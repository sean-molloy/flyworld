/**
don't worry about lihting when opening the curtains at daytime
it can be a comedic moment
abi: Let's let some light in here.
(opens curtains)
abi: Huh. 
abi: practically no light is coming in.
paul: (sigh) even the sun hates me.
*/



/*********************PAULS BEDROOM***************************************START UP*****************************************/

function moveOtherCharIntoPaulsRoomIfInDoorway()
{
  if(cOtherCharacter.Room == eRooms_FlatHallway)
  {
    if(Find.inRect(581, 187, 663, 222, true))
    {
      cOtherCharacter.ChangeRoom(eRooms_PaulsRoom);
    }
  }
}

function room_Load()
{ 

  changePlayerLocaleOnRoomEnter();
  resumeMusicAfterCHCH(aFlat_theme);
  if(Game.DoOnceOnly("setUpPaulsRoom")){
    oCurtains.SetView(39);
    paulBedDark();
  }
  if(cutScenes[4]<3){
    RemoveWalkableArea(2);
  }
  if(lightsOn[eRooms_PaulsRoom]==1)
  {SetBackgroundFrame(0);
  } else {
    SetBackgroundFrame(1);
  }  
  if(GetBackgroundFrame())
  {
    region[3].Tint(0, 10, 250, 60, 50);
    region[4].Tint(0, 10, 250, 60, 50);
    oTypewriter.Tint(0, 10, 250, 80, 50);
    oCurtains.Tint(0, 10, 250, 80, 50);
    
  } else { 
    oTypewriter.RemoveTint();
    region[3].Tint(0, 0, 0, 0, 0);
    region[4].Tint(0, 0, 0, 0, 0);
    oCurtains.Tint(0, 0, 0, 0, 0);
  } 
  Phone.adjustPhoneVolumeWhilstRinging();
  if(characterChange)
  {    
    Game.Camera.SetAt(400, 95);            
  } else {
    Game.Camera.SetAt(HandyHelper.recallCamX(), HandyHelper.recallCamY());
  }
  
    
  moveOtherCharIntoPaulsRoomIfInDoorway();  
    
  if(followed){
    cGhostl.ChangeRoom(eRooms_SpookyZone);   
  } else {
    seeGhost();
  }
  Follow.followStand(195, 147);
  Follow.followFrom(177,  106, 2);
}

function room_AfterFadeIn()
{
  Follow.followMe(3); 
   if(characterChange)
  {
    flashPlayer();
    characterChange = false; 
  } else {
    Game.Camera.TweenPosition(1.0,  400,  95,  eEaseInOutSineTween, eNoBlockTween);
  }
}
/******************************REGIONS*************************************REGIONS************************/


function region1_WalksOnto()
{
//  int remX = player.x + 400;
  //int remY = player.y + 95;
  HandyHelper.memorizeCamPos();
  Game.Camera.StopAllTweens();
  player.ChangeRoom(eRooms_FlatHallway, player.x, player.y);
}

function region2_Standing()
{
  player.z = 3;
}

function region2_WalksOff()
{
  player.z = 0;
}
function region4_WalksOff()
{
player.z = 0;
}
function region4_WalksOnto()
{
  player.z = 3;
}

/*******************************INTERACTION*******************************************INTERACTION****************************/

function pickupTypewriter()
{ 
  cPaul.Walk(677, 236, eBlock);
  cPaul.FaceDirection(eDirectionUpLeft, eBlock);
  cPaul.Say("Okay, I'll pick up the typewriter. Animate this eventually!");
  oTypewriter.Visible = false;
  cPaul.AddInventory(iTypewriter);   
}
function toggleLamp()
{
  getOutOfTheWay(603, 233);
  
  aClick1.Play(eAudioPriorityNormal);
  player.FaceDirection(eDirectionUpLeft, eBlock);
  if(GetBackgroundFrame())
  {
    hLamp.SetTextProperty("defaultVerb","turn off");
    hLamp.SetTextProperty("useVerb","turn off");
    SetBackgroundFrame(0);
    lightsOn[eRooms_PaulsRoom]= 1;
    region[3].Tint(0, 0, 0, 0, 0);     
    region[4].Tint(0, 0, 0, 0, 0);
    oCurtains.Tint(0, 0, 0, 0, 0);
    oTypewriter.RemoveTint();
    if(cutScenes[4] <3)
    {
      paulBedLight();
    }
  } else {
    hLamp.SetTextProperty("defaultVerb","turn on");
    hLamp.SetTextProperty("useVerb","turn on");
    SetBackgroundFrame(1); 
    lightsOn[eRooms_PaulsRoom]= 0;   
    region[3].Tint(0, 10, 250, 60, 50);     
    region[4].Tint(0, 10, 250, 60, 50); 
    oTypewriter.Tint(0, 10, 250, 80, 60);  
    oCurtains.Tint(0, 10, 250, 80, 50);
     if(cutScenes[4] <3)
    {
      paulBedDark();
    } else {
      if(IsPlayerAbi && cPaul.Room == eRooms_PaulsRoom)
      {
        WaitMouseKey(20);
        cPaul.FaceCharacter(cAbi, eBlock);
        cPaul.angry();
        cPaul.Say("Hey!");
        cPaul.cool();
      }
    }
  }
}

function toggleCurtains()
{     
  if(oCurtains.Frame==0)
  {
    getOutOfTheWay(714, 260);
    
   // player.Walk(314, 165, eBlock);
    player.FaceDirection(eDirectionRight, eBlock);
    oCurtains.Animate(0, 0, eOnce, eNoBlock, eForwards);                
  } else {  
    getOutOfTheWay(690, 240);
    
  // player.Walk(290, 145, eBlock);
    player.FaceDirection(eDirectionRight, eBlock);
    oCurtains.Animate(0, 0, eOnce, eNoBlock, eBackwards);
  }
    oCurtains.toggleStatusOpenShut();
    oCurtains.toggleVerbOpenShut();  
}

/************************OBJECTS*******************************************OBJECTS*****************************************/

function takeTypewriter()
{
       if(IsPlayerAbi)
      {
        cAbi.Say("No way, I'm not stealing Paul's stuff.");
        if(cPaul.Room==eRooms_PaulsRoom)
        {
          cPaul.angry();          
          cPaul.Say("Thanks...");
          cPaul.cool();
        }
      } else {
        pickupTypewriter();               
      } 
}

function oTypewriter_AnyClick()
{
  switch (verbUsed)
  {
    case 0: //walk
      walkToAndFace(682, 236, eDirectionUp, 661, 239);          
    break;
    case 1://look
      player.FaceLocation(670, 225, eBlock);
      lookAbiPaul("It's Paul's typewriter.", 
                  "It's my typewriter.");
    break;
    case 2://use
      cPaul.angry();
      lookAbiPaul("Paul will have a hissy-fit if I touch his precious typewriter.",
                  "Nah I need some paper...And some ideas.");    
      cPaul.cool();
    break;
    case 3://talk
      Canned.noTalking();
    break;
    case 4://move
      lookAbiPaul("I'm not messing with Paul's typewriter,",
                  "If I'm going to lift it, I may as well take it with me.");
      if(!IsPlayerAbi)
      {
        pickupTypewriter();
      } else {
        player.Say("it's his prized possession.");
      }
    break;
    case 5://fourletters
      Canned.fuckAnyone();
    break;
    case 6://take
      takeTypewriter();
    break;
    case 7://inv
      Canned.wontWork();
    break;
  }
  verbUsed = 0;
}

function oCurtains_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    if(oCurtains.Frame==0)
    {
      walkToAndFace(714, 260, eDirectionRight, 705, 247);           
    } else {
      walkToAndFace(690, 240, eDirectionRight, 705, 247);     
    }
  break;
  case 1://look
    player.FaceDirection(eDirectionRight, eBlock);
    lookAbiPaul("Whoever decorated this house was a fan of the EGA palette.", 
                "Classic curtains.");
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    toggleCurtains();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;

}


//************************HOTSPOTS***********************************************HOTSPOTS***********************************/

function hLamp_AnyClick()
{
  switch (verbUsed)
  {
    case 0: //walk
      walkToAndFace(603, 233, eDirectionLeft, 615, 234);
      
     // player.Walk(203, 138);
    break;
    case 1://look
      player.FaceLocation(188, 126, eBlock);
      lookAbiPaul("Pretty shabby lamp.", "This lamp cost me $10 on Trademe!");
    break;
    case 2://use
      toggleLamp();            
    break;
    case 3://talk
      Canned.noTalking();
    break;
    case 4://move
      Canned.noMoving();
    break;
    case 5://fourletters
      Canned.fuckAnyone();
    break;
    case 6://take
      cPaul.angry();
      lookAbiPaul("Nah I better not mess with Paul's lamp.","No way, the lamp stays!");  
      cPaul.cool();
    break;
    case 7://inv
      Canned.wontWork();
    break;
  }
  verbUsed = 0;
}

function hPaulsDesk_AnyClick()
{

switch (verbUsed)
{
  case 0: //walk
    player.Walk(276, 141);
  break;
  case 1://look
    lookAbiPaul("It's one of those plastic school desk from the 90's.", 
                "My cozy little writer's nook.");
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    if(oTypewriter.Visible)
    {
      lookAbiPaul("If I open that desk the typewriter will topple over on the floor!",
                  "Not with the typewriter on it!");
    } else {
      lookAbiPaul("I'm not rummaging through Paul's private stuff...I might see something I'll wish I hadn't.",
                  "Maybe someday I will open that desk. Who knows what secrets are within.");
                  //note there should be some rad drawings to give to the tattooist//
    }    
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    if(player.ActiveInventory == iTypewriter)
    {
      oTypewriter.Visible = true;
      player.LoseInventory(iTypewriter);
    } else {
      Canned.wontWork();
    }
  break;
}
verbUsed = 0;

}

function hPosterClown_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    player.Walk(176, 134);
  break;
  case 1://look
  player.FaceLocation(166, 121);
    lookAbiPaul("Sam and the Santown Ghost Clowns.", "Sam and the Santown Ghosts.");
    if(IsPlayerAbi && cPaul.Room == eRooms_PaulsRoom)
    {
      cAbi.FaceCharacter(cPaul);
      cPaul.Say("Great band. Very colourful.");
    }
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    Canned.noMoving();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;
}

function hPosterButs_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    player.Walk(176, 134);
  break;
  case 1://look
  
    player.FaceLocation(166, 121);
    lookAbiPaul("The Buts.", "The Buts.");
     if(IsPlayerAbi && cPaul.Room == eRooms_PaulsRoom)
    {
      cPaul.angry();
      
      cPaul.Say("Those guys are dicks,");
      cPaul.FaceCharacter(cAbi);
      cAbi.FaceCharacter(cPaul);
      cPaul.cool();
      cPaul.Say("But they're so good!");
      cAbi.Say("Sounds like a bunch of good dicks.");
    }
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    Canned.noMoving();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;
}

function hPosterFace_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    player.Walk(306, 156);
  break;
  case 1://look
    player.FaceLocation(342, 160, eBlock);
    lookAbiPaul("David Bain and the Everystreets.", "David Bain and the Everystreets.");
     if(IsPlayerAbi && cPaul.Room == eRooms_PaulsRoom)
    {
      cPaul.Say("I know the bassist!");
      cAbi.FaceCharacter(cPaul);
      WaitMouseKey(25);
      cAbi.awkward();
      cAbi.Say("Cool...");
      cAbi.cool();
    }
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    Canned.noMoving();
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;
}


function hExit_AnyClick()
{
switch (verbUsed)
{
  case 0: //walk
    player.GoTo(207, 105);
  break;
  case 1://look
    lookAbiPaul("That way back to the hall!", "I used to have a door...");
    if(!IsPlayerAbi){
      player.Say("After Campbell smashed up the Einstein door in the lounge,");
      cPaul.angry();
      player.Say("we replaced it with my door."); 
      player.Say("It's such bullshit!");
      cPaul.cool();
    }
  break;
  case 2://use
    Canned.noUsing();
  break;
  case 3://talk
    Canned.noTalking();
  break;
  case 4://move
    lookAbiPaul("Since Paul generously donated his door to fix the broken one in the living room, there is no door to close!",
                "My room doesn't have a door anymore.");
    if(IsPlayerAbi && cPaul.Room == eRooms_PaulsRoom)
    {
      cPaul.angry();
      cPaul.Say("I don't remember volunteering it!");
      cPaul.cool();
    }
  break;
  case 5://fourletters
    Canned.fuckAnyone();
  break;
  case 6://take
    Canned.cantTake();
  break;
  case 7://inv
    Canned.wontWork();
  break;
}
verbUsed = 0;

}

function room_Leave()
{
  HandyHelper.memorizeCamPos();
}

function region1_Standing(Region *theRegion)
{
  region1_WalksOnto();
}
